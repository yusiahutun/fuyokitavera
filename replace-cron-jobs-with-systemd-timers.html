<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=description content="One of the changes systemd brought in was a new way to schedule jobs, with more finesse than cron. Some Linux distributions no longer ship cron. Its time to check out systemd timers. The origins of cron date all the way back to 1975, in Version 7 Unix. Its dependability soon made it a favorite"><meta name=author content="Martina Birk"><meta name=generator content="Hugo 0.98.0"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=robots content="index,follow,noarchive"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/base16/css/style.css type=text/css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" type=text/css><link rel=alternate href=./index.xml type=application/rss+xml title=JadeVibe><title>How (and Why) to Replace cron Jobs With systemd Timers - JadeVibe</title></head><body><header><div class="container clearfix"><a class=path href=./index.html>[JadeVibe]</a>
<span class=caret># _</span><div class=right></div></div></header><div class=container><main role=main class=article><article class=single itemscope itemtype=http://schema.org/BlogPosting><div class=meta><span class=key>published on</span>
<span class=val><time itemprop=datePublished datetime=2024-04-12>April 12, 2024</time></span>
<span class=key>in</span>
<span class=val><a href=./categories/blog>blog</a></span></div><h1 class=headline itemprop=headline>How (and Why) to Replace cron Jobs With systemd Timers</h1><section class=body itemprop=articleBody><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>Why systemd Timers Are Replacing cron</a></li></ul><ul class=table-content-level-1><li><a href=#>How systemd Timers Work</a></li></ul><ul class=table-content-level-1><li><a href=#>Creating a Simple systemd Timer</a></li></ul><ul class=table-content-level-1><li><a href=#>Fine Tuning the Timings</a></li></ul><ul class=table-content-level-1><li><a href=#>Great Flexibility and Ease of Use</a></li></ul><p>One of the changes systemd brought in was a new way to schedule jobs, with more finesse than cron. Some Linux distributions no longer ship cron. It’s time to check out systemd timers.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=why-systemd-timers-are-replacing-cron>Why systemd Timers Are Replacing cron</h2><p>The origins of <a href=#>cron</a> date all the way back to 1975, in Version 7 Unix. Its dependability soon made it a favorite tool for scheduling tasks to run at specified dates and times. Admittedly, its syntax is pretty quirky. If you don’t use it frequently, you’ll probably need to look up the finer points each time you want to <a href=#>schedule a job</a>.</p><p>In cron schedules, days and months are numbered starting at one. The days of the week, however, are numbered from zero to six, for Sunday through to Saturday. And on some systems, seven means Sunday, too. But, as quirky as this might be, it works.</p><p>The systemd service manager brought much more to the table than a simple replacement for the init boot manager. Part of what it delivered was a modern replacement for cron, in the form of systemd timers. These offer more flexibility than cron does, and without the need for another external utility. They’re built right into all systemd distributions.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>That means timers behave the same way on all systemd installations. There are many versions of cron and cron-like substitutes. If you need to have standardization across a number of computers, systemd makes your life easier. The same timers will run the same way on all of them. In fact, some systemd-based distributions no longer ship cron as part of their standard offering.</p><p>Not surprisingly, the Red Hat-derived distributions including <a href=#>Fedora</a> don’t ship cron, because systemd is a <a href=#>Red Hat</a> initiative. Arch and its derivatives don’t include cron, but that's probably more to do with them providing such a minimal distribution that you populate with applications to suit. Other distributions, such as Solus, don't see a need to include cron either. Of course, you could install cron on any distribution you like, but there’s no compelling argument to do so.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p><span class=related-single>Related: <a href=#>Why Linux's systemd is Still Divisive After All These Years</a></span></p><h2 id=how-systemd-timers-work>How systemd Timers Work</h2><p>With systemd timers, you need to create two files. One is a service file. When the service runs, it launches your process for you. So the service file needs to know about your target process.</p><p>The second file you need to create is a timer file. This determines when the service is launched. So the timer file needs to know about your service file.</p><p>Timers can be real-time or monotonic. Real-time timers are triggered by calendar events. Monotonic timers are triggered at some duration after a system event, such as booting. Log entries are added to the system journal for timer events, which can help with debugging.</p><p>You can list the timers on your computer by using the status option of the systemctl command. Several system timers are created automatically, so even if you haven’t created any timers, there will be output to this command.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs xml">systemctl status <span class=hljs-string>"*timer"</span></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/1-22.png><p>Each description contains the following information:</p><ul><li>The timer’s <strong>name</strong> and description, if one was provided.</li><li><strong>Loaded</strong>: Shows the loaded status. Normally our timer is read and loaded into memory. The directory path to the timer file is shown. We’d expect our timer to be “enabled”, but it might be temporarily “disabled” if we’ve chosen to turn it off. The vendor preset indicates whether, when the timer was first created, it was set to “enabled” or “disabled.”</li><li><strong>Active</strong>: Shows the active status, including the date and time when the timer was activated. Typically, you’d expect to see a timer listed as “active”, and “waiting” for its next launch time and date.</li><li><strong>Until</strong>: Confusingly, this line doesn’t apply to timers. We can ignore it.</li><li><strong>Trigger</strong>: Shows the name of the process that is launched by the timer.</li><li><strong>Triggers</strong>: Shows when the timer will next be triggered, and when the process will next be launched.</li><li><strong>Docs</strong>: Some timers have associated documentation. This line is optional, and not always present.</li></ul><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Because timers are actually time-controlled services, we can use the systemctl command to control them.</p><h2 id=creating-a-simple-systemd-timer>Creating a Simple systemd Timer</h2><p>The written word is a static medium, making it difficult to illustrate a process being triggered at a specific time. What we’ll do is create a script that’ll be launched by our new timer, and have it write a timestamp to a logfile. That’ll tell us our service is working, and when it was last triggered.</p><p>We’ll use <a href=#>the date command</a> to generate the timestamp, and we’ll redirect it to a file called “timer.log” in our home directory.</p><p>We’ll create the script in the “/usr/local/bin/” directory. We’re using the “gedit” editor, but you can use whichever editor you prefer.</p><pre><code class="hljs bash">sudo gedit /usr/<span class=hljs-built_in>local</span>/bin/geek-timer.sh </code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/2-20.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Copy these lines into your editor, save the file as “geek-timer.sh”, and close your editor.</p><pre><code class="hljs xml"><span class=hljs-meta>#!/bin/bash</span><p><span class=hljs-built_in>echo</span>&nbsp;<span class=hljs-string>"Timer fired: <span class=hljs-variable>$(date)</span>"</span> &gt;&gt; /home/dave/timer.log</p></code> </pre><p>We’ll need to make our script executable.</p><pre><code class="hljs bash">sudo chmod +x /usr/<span class=hljs-built_in>local</span>/bin/geek-timer.sh</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/4-8.png><p>Let’s just check that our script does what it is meant to.</p><pre><code class="hljs css"><span class=hljs-selector-tag>geek-timer</span><span class=hljs-selector-class>.sh</span><br><span class=hljs-selector-tag>cat</span>&nbsp;<span class=hljs-selector-tag>timer</span><span class=hljs-selector-class>.log</span></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/5-8.png><p>That verifies that our script executes as expected and puts a timestamp into the “timer.log” file.</p><p>Now we’ll create a service file to define the service we want to have launched when the timer is triggered.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class=hljs>sudo gedit /etc/systemd/system/geek-timer.service </code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/6-7.png><p>Copy these lines to your editor, save the file as “/etc/systemd/system/geek-timer.service”, and close your editor.</p><pre><code class="hljs xml"><span class=hljs-selector-attr>[Unit]</span><br>Description=<span class=hljs-string>"How-To Geek systemd timer"</span><br>Requires=geek-timer.timer<p><span class=hljs-selector-attr>[Service]</span><br>Type=simple<br>ExecStart=<span class=hljs-regexp>/usr/</span>local/bin/geek-timer.sh<br>User=dave</p></code> </pre><p>The “[Unit]” section contains two lines. The "Description=" line is a simple one-liner that says what your service is for. The “Requires=” line indicates that this service relies on the “geek-timer.timer” timer file. We’ll create this file next.</p><p>There’s a little bit more in the “[Service]” section. The “Type=” is "simple", meaning this is a basic service. Other options include “oneshot”, which would mean the service ran once only.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>The “ExecStart=” line indicates which process the service should start. This is pointing to our script that we created earlier.</p><p>The “User=” line defines which user should run the command. Without this, the process would be launched by root.</p><p>Now we’ll create the timer file. This defines when the service is launched. It’s good practice to use the same base name for the server and timer files, with different extensions.</p><pre><code class=hljs>sudo gedit /etc/systemd/system/geek-timer.timer</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/7-4.png><p>Copy these lines to your editor, save the file as “/etc/systemd/system/geek-timer.timer”, and close your editor.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs xml"><span class=hljs-selector-attr>[Unit]</span><br>Description=<span class=hljs-string>"Timer for the geek-timer.service"</span><p><span class=hljs-selector-attr>[Timer]</span><br>Unit=geek-timer.service<br>OnBootSec=5min<br>OnUnitActiveSec=1min</p><p><span class=hljs-selector-attr>[Install]</span><br>WantedBy=timers.target</p></code> </pre><p>The “[Unit]” section contains a “Description=” line of text. The “[Timer]” section contains three settings. The “Unit=” line indicates which service should be launched when this timer triggers. The “OnBootSec=” line tells the system to launch the service five minutes after the computer boots. The “OnUnitActiveSec=” line tells the timer to launch the service one minute after it last activated.</p><p>In other words, five minutes after the computer is booted, the service will launch. The service will then repeat with an interval of one minute.</p><p>In the “[Install]” section, we've include a "WantedBy=" line that specifies "timers.target." The "timers.target" is a special target unit that sets up all timer units that are active after boot, and is suitable for all basic systemd timers.</p><p>We can use the systemctl status command to look at our new timer.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs css"><span class=hljs-selector-tag>systemctl</span>&nbsp;<span class=hljs-selector-tag>status</span>&nbsp;<span class=hljs-selector-tag>geek-timer</span><span class=hljs-selector-class>.service</span></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/8-4.png><p>There are no errors reported, which is good. It is inactive because we haven’t started the service. Even if we reboot now, our service and timer won’t be enabled. Let’s start and enable our timer.</p><pre><code class="hljs css"><span class=hljs-selector-tag>sudo</span>&nbsp;<span class=hljs-selector-tag>systemctl</span>&nbsp;<span class=hljs-selector-tag>enable</span>&nbsp;<span class=hljs-selector-tag>geek-timer</span><span class=hljs-selector-class>.timer</span><br><span class=hljs-selector-tag>sudo</span>&nbsp;<span class=hljs-selector-tag>systemctl</span>&nbsp;<span class=hljs-selector-tag>start</span>&nbsp;<span class=hljs-selector-tag>geek-timer</span><span class=hljs-selector-class>.timer</span></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/9-4.png><p>I rebooted the test computer to see if the five-minute grace period after boot-up was respected, and checked its status once more.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs css"><span class=hljs-selector-tag>systemctl</span>&nbsp;<span class=hljs-selector-tag>status</span>&nbsp;<span class=hljs-selector-tag>geek-timer</span><span class=hljs-selector-class>.service</span></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/10-1.png><p>This shows the PC booted at 12:18, and our timer is going to be triggered at 12:23. Our requested five minutes after boot option is being handled correctly. I waited for the five minutes to expire and then quickly ran the same command.</p><pre><code class="hljs css"><span class=hljs-selector-tag>systemctl</span>&nbsp;<span class=hljs-selector-tag>status</span>&nbsp;<span class=hljs-selector-tag>geek-timer</span><span class=hljs-selector-class>.service</span></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/11-2.png><p>We can see that the trigger time has moved on one minute from 12:23 to 12:24. This means we’re now into the "repeating every minute phase" of our timer.</p><p>Checking our logfile a few minutes later, shows the initial trigger time of 12:23, then subsequent launches occur at about a minute apart.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre>cat timer.log</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2023/08/12-2.png><p><span class=related-single>Related: <a href=#>How to List Linux Services With systemctl</a></span></p><h2 id=fine-tuning-the-timings>Fine Tuning the Timings</h2><p>The trigger times of repeating events are slightly fuzzy. That's why I said the events in the logfile are about one minute apart. There’s a small random element added to the trigger time to make sure that timers that are scheduled to trigger at precisely the same time are actually triggered in a staggered fashion. Usually, for tasks like starting a backup or other system housekeeping activities, that’s accurate enough.</p><p>If you need to have a tighter resolution, you can use microsecond timing. Adding this line to the “[Timer]” section of your timer file sets the system to use a one-microsecond resolution.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class=hljs>AccuracySec=1us</code> </pre><p>These are the accuracy settings you can use, and how you can refer to them.</p><ul><li><strong>Microseconds</strong>: us, µs msec, ms</li><li><strong>Seconds</strong>: seconds, second, sec, s</li><li><strong>Minutes</strong>: minutes, minute, min, m</li><li><strong>Hours</strong>: hours, hour, hr, h</li><li><strong>Days</strong>: days, day, d</li><li><strong>Weeks</strong>: weeks, week, w</li><li><strong>Months</strong>: months, month, M</li><li><strong>Years</strong>: years, year, y</li></ul><p>To have a timer trigger at a particular time and date is achieved using the “OnCalendar” setting. This goes in the “[Timer]” section of the timer file. The general format is:</p><pre><code class=hljs>OnCalendar=DayOfTheWeek YYYY-MM-DD HH:MM:SS</code> </pre><p>DayOfTheWeek is optional. Any of the other values be replaced by an asterisk ‘*’ to mean “every”, like every minute or every hour. You can use names or numbers for the days and months, and comma-separated lists to represent selections of values. Ranges of values are indicated by using two periods “..” to separate the start and values of a range.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>This would set a timer to trigger at 01:15 on the first Friday of each month.</p><pre><code class=hljs>OnCalendar=Fri *-*-1..7 01:15:00</code> </pre><p>This would run a process at 19:00 every day.</p><pre><code class=hljs>OnCalendar=*-*-* 19:00:00</code> </pre><p>A timer can have more than one trigger time set. This would run a process at a different time on business days than on the weekend.</p><pre><code class="hljs xml">OnCalendar=Mon..Fri 23:00:00<br>OnCalendar=Sat,Sun 19:00:00</code> </pre><p>The <a href=# rel="noopener noreferrer">systemd time man page</a> full description of time formats and many useful tips and tricks.</p><h2 id=great-flexibility-and-ease-of-use>Great Flexibility and Ease of Use</h2><p>Much of the flexibility of systemd timers resides in the way you can cater for odd-ball calendar events. For example, to set a timer to trigger at 15:00 on all days apart from Fridays, you can use this format:</p><pre><code class="hljs css"><span class=hljs-selector-tag>Mon</span>.<span class=hljs-selector-class>.Thu</span>,<span class=hljs-selector-tag>Sat</span>,<span class=hljs-selector-tag>Sun</span> *<span class=hljs-selector-tag>-</span>*<span class=hljs-selector-tag>-</span>* 15<span class=hljs-selector-pseudo>:00</span><span class=hljs-selector-pseudo>:00</span></code> </pre><p>By combining comma-separated lists and ranges you’ll find it easy to create real-time triggers for all manner of complicated requirements.</p><p>Once you've got the idea that you create a service to launch your process, and a timer file to govern the launching of the service, you're 90 percent of the way to understanding systemd timers. The last 10 percent is embracing the graceful power of calendar events.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p><span class=related-single>Related: <a href=#>How to Run a Linux Program at Startup With systemd</a></span></p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGipnqiclrCmecKrpqdlmqSvtHnWoquhZaOuwLWxzJ1kraGdmr%2B0ew%3D%3D</p></section></article></main></div><footer><div class=container><span class=copyright>&copy; 2024 JadeVibe - <a rel=license href=http://creativecommons.org/licenses/by/4.0/>CC BY 4.0</a></span></div></footer><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>